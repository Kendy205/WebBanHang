@model IEnumerable<WebBanHang.Models.Models.Food>
@{
    ViewData["Title"] = ViewBag.Title ?? "Danh sách món ăn";
    var categories = ViewBag.Categories as IEnumerable<WebBanHang.Models.Models.Category>;
}

<div class="container mt-4">
    <div class="row">
        <!-- ===== Sidebar ===== -->
       
        <div class="col-md-3">
            @* Danh mục *@
            <h5 class="fw-bold">Danh mục</h5>
            <ul class="list-group mb-4">
                @foreach (var c in categories)
                {
                    <li class="list-group-item">
                        <a asp-action="Category" asp-route-id="@c.CategoryId"
                           class="text-decoration-none">
                            @c.CategoryName
                        </a>
                    </li>
                }
            </ul>

            <h5 class="fw-bold">Lọc theo giá</h5>
            <form asp-action="Index" asp-controller="Food" asp-area="Customer" method="get">
                <div class="mb-2">
                    <label for="minPrice" class="form-label">Giá thấp nhất</label>
                    <input type="number" name="minPrice" id="minPrice" class="form-control" value="@ViewBag.MinPrice" placeholder="0" />
                </div>
                <div class="mb-2">
                    <label for="maxPrice" class="form-label">Giá cao nhất</label>
                    <input type="number" name="maxPrice" id="maxPrice" class="form-control" value="@ViewBag.MaxPrice" placeholder="100000" />
                </div>
                <button type="submit" class="btn btn-sm btn-primary w-100" asp-action="Index">Lọc</button>
            </form>
          

            <hr />
            @* tìm kiếm  *@
            <h5 class="fw-bold">Tìm kiếm</h5>
            <form asp-action="Search" asp-controller="Foods" asp-area="Customer" method="get">
                <input type="text" name="keyword" value="@ViewBag.Keyword" class="form-control" placeholder="Nhập tên món ăn..." />
                <button type="submit" class="btn btn-sm btn-success w-100 mt-2" asp-action="Search">Tìm kiếm</button>
            </form>
        </div>

        <!-- ===== Danh sách món ăn ===== -->
        <div class="col-md-9">
            <h4 class="mb-3">@ViewData["Title"]</h4>
            <div class="row">
                @foreach (var item in Model)
                {
                    <div class="col-md-4 mb-4">
                        <div class="card h-100 shadow-sm border-0">
                            <img src="@item.ImageUrl" class="card-img-top" alt="@item.FoodName" />
                            <div class="card-body">
                                <h6 class="card-title">@item.FoodName</h6>
                                <p class="text-muted mb-1">@item.Price.ToString("N0") đ</p>
                                <small>@item.Description</small>
                            </div>
                            <div class="card-footer bg-transparent border-0">
                                <a href="@Url.Action("Details", "Food", new { area = "Customer", id = item.FoodId })" class="btn btn-sm btn-outline-primary w-100">Chi tiết</a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

        <!-- Phân trang -->
        <nav>
            <ul class="pagination justify-content-center">
                @for (int i = 1; i <= ViewBag.TotalPages; i++)
                {
                    <li class="page-item @(i == ViewBag.CurrentPage ? "active" : "")">
                        <a class="page-link" href="@Url.Action("Index", 
                        new { area = "Customer", page = i, categoryId = ViewBag.CurrentCategory, minPrice = ViewBag.MinPrice, maxPrice = ViewBag.MaxPrice, sortBy = ViewBag.SortBy })">@i</a>
                    </li>
                }
            </ul>
        </nav>
    </div>
</div>
